# MAINTENANCE
maintenance:update_changelog:
  image: alpine/curl
  stage: maintenance
  interruptible: true
  tags: [minds-ci]
  script:
    # gets commits from the last tag to the commit which is tagged (including the commit)
    - 'curl --request POST --header "PRIVATE-TOKEN: $PROJECT_TOKEN" "https://gitlab.com/api/v4/projects/10171280/repository/changelog?from=$(git describe --tags --abbrev=0)&to=$CI_COMMIT_SHA" --data "branch=master&version=$CI_COMMIT_TAG&message=[skip ci] Add changelog for $CI_COMMIT_TAG"'
  only:
    refs:
      - /^master$/
      - tags
